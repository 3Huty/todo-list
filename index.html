<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>To-do List</title>
    <!-- <link rel="stylesheet" href="style.css"> -->
	
	<style type="text/css">
		ul{
			float: left;
			width: 15em;
			border: solid 1px black;
		}
		
		li {
			margin-bottom: 10px;
			color: red;
		}
		
		li:hover {
			background-color: black;
		}
		 
		li button {
			font-size: 8px;
			margin-left: 20px;
			color: #666;
		}

		#editor {
			float: left;
			width: 25em;
			margin-left: 3em;
		}
		
		#editor.new #deletebtn {
			visibility: hidden;
		}

		#editor.edit #deletebtn {
			visibility: visible;
		}
	</style>
	
	<script type="text/javascript">
		// będziemy tu trzymać wybrany ToDo, czyli ten na który klinięto i możemy do edytować
		// na początku powinien mieć wartość undefined
		var selectedToDo;
		
		
		window.onload = function(){
			console.log("Wiem ze strona zaladowala sie");
			console.log("selectedToDo: " + selectedToDo);
			// zacznij wykonywać kod JS dopiero gdy cała strona się wczyta razem ze wszyskimi grafikami oraz stylami i innymi JSami
			
		
			// tu zacznij dodawać kod javascriptowy
			document.getElementById("todolist").onclick = loadToDo;
			document.getElementById("newbtn").onclick = newToDo;
			document.getElementById("savebtn").onclick = saveToDo;	
            document.getElementById("clearbtn").onclick = clearToDo;
 		}
		
		
		// ustawiamy edytor w odpowiedni trybie
		// new - wprowadzamy treść nowego zadania
		//		przycisk Delete nie jest widoczny
		//
		// edit - modyfikujemy treść wybranego zadania
		//		jest widoczny przycisk Delete
		function changeEditorMode(mode) {
			var editor = document.getElementById("editor");
			var textArea = document.getElementById("item");
			
			if (mode == "new") {
				editor.className = "new";
				textArea.value = "";
			}
			
			if (mode == "edit") {
				editor.className = "edit";
			}
			
			textArea.focus();									// kursor ma od razu wskoczyć do pola edycyjnego
		}
		
		
               
		// tutaj dodaj funkcję która podepniesz do przycisku "New"
		// naciśnięcie na New ma wyczyścić pole tekstowe i upewnić się że przycik "Delete" nie jest widoczny
		// bo to w końcu nowy wpis który jeszcze nie został dodany
		function newToDo() {
			changeEditorMode("new");
			
			// jako że przygotowaliśmy się do edycji nowego wpisu, to nie interesuje nas czy wcześniej jakiś wybraliśmy
			selectedToDo = undefined;
            
            
		}
		
		
		// wywolane gdy klikniemy na liste. Dzięki temu mozemy sprawdzić który element listy był klinięty
		// a przez to pobrać treść ToDosa
		function loadToDo(event){
			console.log("kliknieto w liste");
			console.log("event.target: " + event.target.tagName);
			console.log("event.target.value: " + event.target.innerHTML);
			
			changeEditorMode("edit");
			
			document.getElementById("item").value = event.target.innerHTML;
			document.getElementById("editor").className = "edit";
			
			// zapamiętajmy który wpis wybraliśmy
			selectedToDo = event.target;
        
        
        }
            
  
		function saveToDo() {
			// bedzie potrzebny zeby pobrać treść todo do dodania
			var textArea = document.querySelector("#item");
			
			// nowy ToDo w którym zapiszemy treść zadania
			var newTODO = document.createElement("li");
			newTODO.innerHTML = textArea.value;
			
			// trzeba podpiąć tego nowego ToDosa do listy żeby pojawił się na stronie
			var todos = document.getElementById("todolist");
			todos.appendChild(newTODO);
           
        }		
			// a to po to żebyśmy mieli edytor gotowy do wpisania treśći kolejnego nowego ToDosa
			changeEditorMode("new");
            selectedToDo = undefined;
        
        
        // Wyczysczenie listy przyciskiem ClearAll
        function clearToDo() {
            var emptyList = document.getElementById("todolist"); 
             if (document.getElementById("clearbtn").checked) {
                emptyList = emptyList.clear;     
            
        }
                emptyList.style.visibility = "hidden";
        
        }
        
        // localStorage z aktualnymi zadaniami
      var currentList = document.getElementById("todolist");
      localStorage.setItem("myElement", JSON.stringify(currentList));

      var retrievedObject = localStorage.getItem("myElement");
      console.log(JSON.parse(retrievedObject));  
     
    
        
	</script>
  </head>
  
  <body>

    <h1>My To-do list</h1>
      
      <div>
      <button id="clearbtn">Clear All</button>
      </div>
      
	<ul id="todolist">
		<li data-status="pending">Buy bread</li>
		<li data-status="finished">Send an invoice</li>
     </ul>
      
    <div id="editor" class="new">
      <label for="item">What do I need to do?</label>
      <textarea name="item" id="item" placeholder="Write what you need to do" cols="30" rows="3"></textarea>
      
      <div>
		  <button id="newbtn">New</button>
          <button id="savebtn">Save</button>
		  <button id="deletebtn">Delete</button>
	  </div>
    </div>
      
          
    <!--<script src="main.js"></script>-->  
  </body>
</html>